{% extends 'base.html' %}
{% block title %}Study FlashCards{% endblock %}

{% block content %}
<h4 class="mb-4">Study FlashCards</h4>

<!-- Category Selector -->
<form method="get" class="mb-4">
    <label for="category" class="form-label">Select Category:</label>
    <select name="category" id="category" class="form-select" onchange="this.form.submit()">
        <option value="">-- Choose a category --</option>
        {% for cat in categories %}
        <option value="{{ cat.id }}" {% if cat.id|stringformat:"s" == selected_category_id %}selected{% endif %}>
            {{ cat.name }}
        </option>
        {% endfor %}
    </select>
</form>

{% if flashcards %}
<div class="d-flex justify-content-center">
    <div class="flashcard" id="flashcard">
        <div class="front p-3">
            <strong>Q:</strong> <span id="question">{{ flashcards.0.question }}</span>
        </div>
        <div class="back p-3">
            <strong>A:</strong> <span id="answer">{{ flashcards.0.answer }}</span>
        </div>
    </div>
</div>

<div class="d-flex justify-content-center mt-3">
    <button id="prev" class="btn btn-outline-secondary me-2">Previous</button>
    <button id="next" class="btn btn-outline-secondary">Next</button>
</div>

<style>
.flashcard {
    width: 400px;
    height: 200px;
    perspective: 1000px;
    cursor: pointer;
    position: relative;
}
.flashcard .front, .flashcard .back {
    width: 100%;
    height: 100%;
    border: 2px solid #e3342f;
    border-radius: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    backface-visibility: hidden;
    position: absolute;
    transition: transform 0.6s;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    background: #fff;
}
.flashcard .back {
    transform: rotateY(180deg);
    background: #ffe5e5;
}
.flashcard.flipped .front { transform: rotateY(180deg); }
.flashcard.flipped .back { transform: rotateY(0deg); }
</style>

<script>
// Prepare flashcards data
const flashcards = [
    {% for card in flashcards %}
    {question: "{{ card.question|escapejs }}", answer: "{{ card.answer|escapejs }}"},
    {% endfor %}
];

let currentIndex = 0;
const flashcardEl = document.getElementById('flashcard');
const questionEl = document.getElementById('question');
const answerEl = document.getElementById('answer');

// Flip card
flashcardEl.addEventListener('click', () => {
    flashcardEl.classList.toggle('flipped');
});

// Next button
document.getElementById('next').addEventListener('click', () => {
    currentIndex = (currentIndex + 1) % flashcards.length;
    updateCard();
});

// Previous button
document.getElementById('prev').addEventListener('click', () => {
    currentIndex = (currentIndex - 1 + flashcards.length) % flashcards.length;
    updateCard();
});

// Update card content
function updateCard() {
    flashcardEl.classList.remove('flipped');
    questionEl.textContent = flashcards[currentIndex].question;
    answerEl.textContent = flashcards[currentIndex].answer;
}
</script>
{% else %}
<p class="text-muted">Select a category to start studying flashcards.</p>
{% endif %}

{% endblock %}
