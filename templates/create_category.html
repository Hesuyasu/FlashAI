{% extends 'base.html' %}
{% load static %}
{% block title %}Add Category{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
<style>
.category-form-panel.comic-panel { padding:1.4rem 1.6rem; }
.category-form-panel form label { font-weight:600; color:#d94545; }
.category-form-panel form input { width:100%; padding:.7rem 1rem; border:2px solid #333; border-radius:14px; background:#fffdfc; box-shadow:3px 3px 0 #f08f7f; }
.category-form-panel form input:focus { outline:none; transform:translate(-3px,-3px); box-shadow:6px 6px 0 #f08f7f; }
.add-btn { background:#f08f7f; color:#fff; font-weight:700; border:3px solid #333; border-radius:24px; padding:.65rem 1.25rem; box-shadow:4px 4px 0 #f08f7f; transition:transform .2s, box-shadow .2s, background .2s; }
.add-btn:hover { background:#d94545; transform:translate(-4px,-4px); box-shadow:7px 7px 0 #f08f7f; }
.categories-list { list-style:none; padding:0; margin:0; }
.categories-list li.comic-panel { margin-bottom:.65rem; padding:.7rem 1rem; display:flex; justify-content:space-between; align-items:center; }
.categories-list li span { font-weight:600; color:#333; }
.delete-cat-btn { background:#ffdede; color:#d94545; border:2px solid #333; font-weight:700; border-radius:16px; padding:.35rem .9rem; box-shadow:3px 3px 0 #f08f7f; transition:transform .2s, box-shadow .2s; }
.delete-cat-btn:hover { transform:translate(-3px,-3px); box-shadow:6px 6px 0 #f08f7f; }
</style>
{% endblock %}

{% block content %}
<div class="comic-dashboard">
    <h2 class="mb-4 comic-heading"><span>Manage Categories</span></h2>
    <div class="category-form-panel comic-panel mb-4">
        <form method="post" class="row g-2 align-items-end">
            {% csrf_token %}
            <div class="col-md-8">{{ form.name.label_tag }} {{ form.name }}</div>
            <div class="col-md-4 text-md-end"><button class="add-btn w-100" type="submit">Add Category</button></div>
        </form>
        <div class="form-text mt-2">Tip: Adding a category lets you reuse it for flashcards and uploads.</div>
        <div class="mt-4">
            <h6 class="mb-3" style="color:#d94545;font-weight:800;">Existing Categories</h6>
            {% if categories %}
            <ul class="categories-list">
            {% for cat in categories %}
                <li class="comic-panel">
                    <span>{{ cat.name }}</span>
                    <form method="post" action="{% url 'delete_category' cat.id %}" onsubmit='return confirm("Delete category {{ cat.name|escapejs }}? This will remove associated flashcards.");'>
                        {% csrf_token %}
                        <button type="submit" class="delete-cat-btn">Delete</button>
                    </form>
                </li>
            {% endfor %}
            </ul>
            {% else %}
            <p class="text-muted mb-0">No categories yet. Add your first above.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}