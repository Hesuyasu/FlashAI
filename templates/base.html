{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>{% block title %}Dashboard{% endblock %}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="{% static 'css/custom.css' %}">
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    {% block extra_css %}{% endblock %}
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-auto col-md-2 px-0 sidebar">
                <div class="ps-logo text-center">FlashAI</div>
                <nav class="nav flex-column">
                    <a class="nav-link {% if request.resolver_match.url_name == 'home' %}active{% endif %}"
                        href="{% url 'home' %}">
                        <i class="bi bi-house-fill"></i> Dashboard
                    </a>
                    <a class="nav-link {% if request.resolver_match.url_name == 'create_flashcard' %}active{% endif %}"
                        href="{% url 'create_flashcard' %}">
                        <i class="bi bi-file-earmark-plus-fill"></i> Create FlashCard
                    </a>
                    <a class="nav-link {% if request.resolver_match.url_name == 'flashcard_list' %}active{% endif %}"
                        href="{% url 'flashcard_list' %}">
                        <i class="bi bi-journal-text"></i> FlashCard List
                    </a>
                    <a class="nav-link {% if request.resolver_match.url_name == 'upload_pdf' %}active{% endif %}"
                        href="{% url 'upload_pdf' %}">
                        <i class="bi bi-file-earmark-pdf-fill"></i> Upload PDF
                    </a>
                    <a class="nav-link {% if request.resolver_match.url_name == 'study_flashcards' %}active{% endif %}"
                        href="{% url 'study_flashcards' %}">
                        <i class="bi bi-file-earmark-pdf-fill"></i> Study Mode
                    </a>
                    <form method="post" action="{% url 'account_logout' %}" class="mt-2">
                        {% csrf_token %}
                        <button type="submit" class="nav-link text-start" style="background:none;border:none;width:100%;">
                            <i class="bi bi-box-arrow-right"></i> Logout
                        </button>
                    </form>
                </nav>
            </div>

            <!-- Main content -->
            <div class="col py-3">
                {% block content %}
                <h2 class="mb-4">Dashboard</h2>

                <div class="row g-4">
                    <!-- Flashcard count -->
                    <div class="col-md-4">
                        <div class="dashboard-stat">
                            <h3 id="flashcard-count">{{ flashcard_count }}</h3>
                            <p>Total FlashCards</p>
                        </div>
                    </div>

                    <!-- Suggestion: Add more boxes -->
                    <div class="col-md-4">
                        <div class="dashboard-stat">
                            <h3>‚≠ê</h3>
                            <p>Recently Added</p>
                        </div>
                    </div>

                    <div class="col-md-4">
                        <div class="dashboard-stat">
                            <h3>üìà</h3>
                            <p>Activity Overview</p>
                        </div>
                    </div>
                </div>

                <!-- Optionally, you can add charts or interactive elements here -->
                {% endblock %}
            </div>
        </div>
    </div>

    <!-- Optional JS for real-time updates -->
    <script>
        // Example: auto-refresh flashcard count every 10s
        setInterval(() => {
            fetch("{% url 'api_flashcard_count' %}")
                .then(res => res.json())
                .then(data => {
                    document.getElementById('flashcard-count').innerText = data.count;
                });
        }, 10000);
    </script>
</body>

</html>